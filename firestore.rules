service cloud.firestore {
  match /databases/{database}/documents {
    match /households/{householdId} {
      allow create, read: if request.auth.uid != null;
    }
    match /households/{householdId} {
    	function validUpdate()
      {
      	return !(request.resource.data.keys().hasAll(["users"]))
        				|| (resource.data.users[request.auth.uid].role == "owner");
			}

			allow update: if validUpdate();
    }
  }
}